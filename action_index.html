<html>
  <head>
    <link rel="stylesheet" type="text/css" href="/static/style.css">
    <link rel="stylesheet" type="text/css" href="https://love.sam.ai/xenon/css/bootstrap.css?v=07March">
    <link rel="stylesheet" type="text/css" href="https://love.sam.ai/xenon/css/xenon-forms.css?v=07March">
     <script src="/static/js/voice.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <style>
          .action-elem-new-selected {
border-radius: 12px !important;
/* border: solid 1px #ffff33; */
padding: 4px 12px;
/* background: #e5e9ec; */
margin-right: 7px;
font-size: 12px;
/* font-weight: bold; */
color: #ffffff;
/* color: #000; */
display: inline-block;
margin-bottom: 10px;
cursor: pointer;
background: -webkit-linear-gradient(-466deg, rgba(211,72,252,1) 0%, rgba(133,133,206,1) 39%, rgba(255,255,155,1) 100%);
text-decoration: none;
}
      </style>
  </head>

  <script type="text/javascript"> 

    $(document).ready(function(){ 

        var tmp_userid = GetURLParameter('userId');
        var tmp_userclientid = GetURLParameter('userClientId');

        var tmp_username_full = decodeURIComponent(GetURLParameter('userName'));
        var tmp_username_full_arr = tmp_username_full.split(" ");
        //var tmp_username = tmp_username_full_arr[0];
        var tmp_username=tmp_username_full;


        var tmp_userimage = GetURLParameter('userImage'); 

        $("#sp_userdetails").attr('data-sp_userid',tmp_userid);
        $("#sp_userdetails").attr('data-sp_username',tmp_username);
        $("#sp_userdetails").attr('data-sp_userclientid',tmp_userclientid);
        $("#sp_userdetails").attr('data-sp_userimage',tmp_userimage);

        $("#name_label_id").html(tmp_username);


         window.addEventListener('message', function(event) { 
           // alert('got message');
           // alert('event.origin='+event.origin);
            //alert('event.data='+event.data);  
            // IMPORTANT: Check the origin of the data! 
              

           var msg_arr=event.data.split("|~&|");

            var tmp_userid_arr=msg_arr[0].split("=");
           var tmp_userid=tmp_userid_arr[1];
          // alert('tmp_userid='+tmp_userid); 

           var tmp_userclientid_arr=msg_arr[1].split("=");
           var tmp_userclientid=tmp_userclientid_arr[1];
          // alert('tmp_userclientid='+tmp_userclientid); 
 
           var tmp_username_arr=msg_arr[2].split("=");
           var tmp_username=tmp_username_arr[1];

           // var tmp_username_full_arr = tmp_username_arr[1];
            //var tmp_username = tmp_username_full_arr[0];


            //alert('tmp_username='+tmp_username);

           var tmp_userimage_arr=msg_arr[3].split("=");
           var tmp_userimage=tmp_userimage_arr[1];
          // alert('tmp_userimage='+tmp_userimage); 

           $("#sp_userdetails").attr('data-sp_userid',tmp_userid);
           $("#sp_userdetails").attr('data-sp_username',tmp_username);
           $("#sp_userdetails").attr('data-sp_userclientid',tmp_userclientid);
           $("#sp_userdetails").attr('data-sp_userimage',tmp_userimage);
  
            var tmp_username=$("#sp_userdetails").attr('data-sp_username');
           // alert('tmp_username='+tmp_username);
            $("#name_label_id").html(tmp_username);

        });
		
		
		window.addEventListener('message', function(event) { 
			/* alert('got message111'); 
			alert('event.origin='+event.origin);
			alert('event.data='+event.data);  */

			var parent_msg_arr=event.data.split("=");
			var parent_msg_attr=parent_msg_arr[0];
			var parent_msg_attr_val=parent_msg_arr[1];
			// alert('parent_msg_attr='+parent_msg_attr);
			//alert('parent_msg_attr_val='+parent_msg_attr_val); 
			if(parent_msg_attr=="question" && parent_msg_attr_val!=""){ 
			       $('#textInput').val(parent_msg_attr_val);   
				   $("#buttonInput").click(); 
				   
			} 
			
			if(parent_msg_attr=="email_msg1111" && parent_msg_attr_val!=""){  
				   var tmpMsgArr=parent_msg_attr_val.split("~");
				   var err_msg=tmpMsgArr[0];
				   var err_req_id=tmpMsgArr[1]; 
				//	alert('err_msg='+err_msg);
				//	alert('err_req_id='+err_req_id);
				    $("#email_alert_id_"+err_req_id).html(err_msg);  
			}

			if(parent_msg_attr=="email_msg" && parent_msg_attr_val!=""){  
				var tmpMsgArr=parent_msg_attr_val.split("~");
				var err_msg=tmpMsgArr[0];
				var err_req_id=tmpMsgArr[1]; 
				var err_success=tmpMsgArr[2]; 
				
				/*  alert('err_msg='+err_msg);
				alert('err_req_id='+err_req_id);
				alert('err_success='+err_success);*/
				if(err_success=='true'){ 
					$("#email_alert_id_"+err_req_id).css("background","#8DC63F");
				}else{ 
					$("#email_alert_id_"+err_req_id).css("background","#F7AA47");
				}
				
				$("#email_alert_id_"+err_req_id).html(err_msg);  
			}  

			if(parent_msg_attr=="callAddActionLeadReturnId" && parent_msg_attr_val!=""){   
				var tmpMsgArr1=parent_msg_attr_val.split("~");
				var tmpValLead=tmpMsgArr1[0];
				var tmpValType=tmpMsgArr1[1];

				var tmpValTypeStr='Lead';
				if(tmpValType==2){
					var tmpValTypeStr='Opportunity';
				} else if(tmpValType==3){
					var tmpValTypeStr='Account';
				} else if(tmpValType==4){
					var tmpValTypeStr='Partner';
				} 

				var tmpMsg = tmpValTypeStr+" added successfully.Please <a target='_blank' href='https://love.sam.ai/leadDetail.php?leadId="+tmpValLead+"'>click here</a> to view the profile page"; 
				samResponseUpdate(tmpMsg,tmpValLead); 
			}

			if(parent_msg_attr=="callAddActionContactReturnId" && parent_msg_attr_val!=""){  
				var tmpMsgArr1=parent_msg_attr_val.split("~");
				var tmpValLead=tmpMsgArr1[0];
				var tmpValType=tmpMsgArr1[1]; 

				var tmpMsg="Contact added successfully.Please <a target='_blank' href='https://love.sam.ai/leadDetail.php?contactId="+tmpValLead+"'>click here</a> to view the profile page"; 
				samResponseUpdate(tmpMsg,tmpValLead); 
			}
	   }); 
	   
 
        $("#textInput").focusout(function() { 
                   $(this).focus();
             });

	 $('#check-iframeSwitch').click(function(){ 
                       //alert("check Switch to support");
                       window.parent.postMessage('clickedSupport=1', '*');
         });


            $('.questionRadio').click(function(){    
                      var questionType=$(this).val();   
                      $('#action_type').prop('checked', true);
                      $('#data_type').prop('checked', false);
                      $('#support_type').prop('checked', false);

                      if(questionType=='data'){
                           window.parent.postMessage('clickedSupport=0', '*');  
                      }else if(questionType=='support'){
                          window.parent.postMessage('clickedSupport=1', '*'); 
                      }else if(questionType=='action'){
                         window.parent.postMessage('clickedSupport=2', '*');  
                      }
              });

 
 
               $( "#textInput_old1").autocomplete({
                  source: 'https://love.sam.ai/chatbot/getAIChatbotReport.php?isSetAutoComplete=1&support=0',
                  autoFocus: false,
                  autoScroll: true,
                  select: function (event, ui) {
                          //$('.ui-autocomplete').hide();
                           $("#textInput").val(ui.item.label);
                           getBotResponse();

                          //var tmp=$("#textInput").val();
                         // alert('tmp= '+tmp);
                  },
                   position: {
                     my: "left bottom",
                     at: "left top",
                  },
                   minLength: 3
               }).focus(function(){
                      // $("#textInput").val("");
                       $(this).autocomplete("search", "");
               });

                
              function GetURLParameter(sParam){
                 var sPageURL = window.location.search.substring(1);
                // alert('sPageURL='+sPageURL);
                 var sURLVariables = sPageURL.split('&');
                  for (var i = 0; i < sURLVariables.length; i++) 
                  {
                      var sParameterName = sURLVariables[i].split('=');
                      if (sParameterName[0] == sParam) 
                      { 
                          
                          return sParameterName[1];
                      }
                  }

               // return 1;
              } 


	      function samResponseUpdate(data,retId){

                  var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                  var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";

                  $("#chatbox").append(botHtml); 

                  var tmpHeight=parseInt(tmpPreviousHeight);
                  $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
              }

 
              function getBotResponse() {

                    var rawText = $("#textInput").val();
                    if(rawText)
                    {
                    //var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';
 
                    /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */

                    /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                     var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid"); 
                     var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); 
                     var tmp_username=$('#cb_ses_details',parent.document).attr("data-username");*/

                     var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                     var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                     var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                     var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                     var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                    // alert('tmp_userimg='+tmp_userimg);

                     var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";
 

                    $("#textInput").val("");
                    $("#chatbox").append(userHtml);

                     var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                     $("#chatbox").append(loadingReport);

                    //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                    var tmpHeight = document.getElementById("chatbox").scrollHeight;
                    $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                    $.get("/action/bot/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                     // var botHtml = '<p class="botText"><span>' + data + '</span></p>';
                     var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";

                      $("#chatbox").append(botHtml);

                        /* Start Display Date */
                                var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                //alert('dateFilterFlag='+dateFilterFlag);

                                if(dateFilterFlag!=-1){
                                     var tmpDateHtml=$("#dateSpan").html();
                                     // alert('tmpDateHtml='+tmpDateHtml);
                                      var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                      $("#chatbox").append(botHtml);
                                }
                        /* End Display Date */


                       $(".loader").hide();
                     // document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                    // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                     var tmpHeight=parseInt(tmpPreviousHeight);
                     $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                    });
                    }
               }
               $("#textInput").keypress(function(e) {
                      if(e.which == 13) {
                      //alert(e.which);
                          getBotResponse();
                          $('#textInput').autocomplete("search", ""); 
                      }
               });
               /*$("#buttonInput").click(function() {
                    getBotResponse();
		    $('#textInput').focus();
                    $('#textInput').autocomplete("search", "");
               });*/

	       	$("#buttonInput").click(function() { 
                    var tmp_msg=$('#textInput').val();
                    //alert("tmp_msg="+tmp_msg); 
                    getBotResponse();
                    $('#textInput').focus();
                    $('#textInput').autocomplete("search", "");   
               });  

            });

              function showMoreList(request_id) {
                 //  alert('hi i come from iframe'+request_id);
                   parent.showMoreAiResultList(request_id);

                  // $("parent#show_more_ai").click();
               }
               function showChatbotPopup_OLD(request_id) {
                  //  alert('hi i come from iframe'+request_id);
                    //parent.showMoreAiResultList(request_id);
                    // alert('request_id='+request_id);
                     window.open("https://love.sam.ai/chatbot/showAIReportList.php?request_id="+request_id,"_blank","width=650,height=500,titlebar=no");
                   // $("parent#show_more_ai").click();
             }
			 
			 function showChatbotPopup(request_id,filter_field,filter_field_value){  
					 var filter_field_value=encodeURIComponent(filter_field_value);
                     var launchURL="https://love.sam.ai/chatbot/showAIReportList.php?request_id="+request_id+"&filter_field="+filter_field+"&filter_field_value="+filter_field_value;
                     window.open(launchURL,"_blank","width=650,height=500,location=0,menubar=no,toolbar=no");   
             }  
			 
             function showChatbotPopupquestions(request_id) {
                  //  alert('hi i come from iframe'+request_id);
                    //parent.showMoreAiResultList(request_id);
                    // alert('request_id='+request_id);
                     window.open("https://love.sam.ai/chatbot/showAIReportList.php?request_id=3509","_blank","width=650,height=500,titlebar=no");
                   // $("parent#show_more_ai").click();
             }
             function sendReportInEmail(request_id){
                    var launchURL="https://love.sam.ai/chatbot/sendAIReportListInEmail.php?request_id="+request_id+"&req_from_sendemail=1";
                    window.open(launchURL,"_blank","width=650,height=500,location=0,menubar=no,toolbar=no");
            }
			
			function sendReportInEmailFromChatbot(request_id){ 
					
					/* alert("I am in sendReportInEmailNew");*/

					/*var sendingReport11="<div class='loader'><div id='loadingText'>Sending report in email.Please wait</div><div id='loadingImg'><img border=0 src='static/images/loading.gif'></img></div></div>";*/

					var sendingReport="<span class='loader'><span id='loadingTextEmail'>Sending Sending</span><span id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></span></span>";


					$("#email_alert_id_"+request_id).css("background","none");
					$("#email_alert_id_"+request_id).show();  				   
					$("#email_alert_id_"+request_id).html(sendingReport);  


					if( /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) ) {
							//alert("Mobile...");
							var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
							var launchURL = launchURL.concat("&mb_user_id="+tmp_userid);  
							window.parent.postMessage('sendReportListinEmailMobileURL~=~'+request_id, '*');  

					}else{
							 /*alert("System");*/
							window.parent.postMessage('sendReportListinEmailURL='+request_id, '*');   
					} 
					 
			} 


               function clickMe(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage"); 
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid"); 
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/chatbot/getDateConfirmation/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
		function clickAction(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/main/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               function clickSig(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/signature/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               function clickTrans(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/transfer_folder/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               function clickCreate(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/create_folder/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               function clickActionConv(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');

                           var tmpPreviousHeight = document.getElementById("chatbox").scrollHeight;

                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/convert/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');

                            /* Start Display Date */
                                    var dateFilterFlag = data.lastIndexOf("displayAIDates");
                                    //alert('dateFilterFlag='+dateFilterFlag);

                                    if(dateFilterFlag!=-1){
                                         var tmpDateHtml=$("#dateSpan").html();
                                         // alert('tmpDateHtml='+tmpDateHtml);
                                          var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+tmpDateHtml+"</span></div></div>";
                                          $("#chatbox").append(botHtml);
                                    }
                            /* End Display Date */


                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                             // var tmpHeight = document.getElementById("chatbox").scrollHeight;
                             var tmpHeight=parseInt(tmpPreviousHeight);
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }

               function UserConfimation(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');


                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/chatbot/userconfirmationofquestion/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');
                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                              var tmpHeight = document.getElementById("chatbox").scrollHeight;
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               function clickMeHere(valstr) {
                      var rawText = valstr;
                      if(rawText){
                         // var userHtml = '<p class="userText"><span>' + rawText + '</span></p>';

                         /* var tmp_userimg=$('#cb_ses_details',parent.document).attr("data-userImage");
                          var tmp_userid=$('#cb_ses_details',parent.document).attr("data-userid");
                          var tmp_userclientId=$('#cb_ses_details',parent.document).attr("data-userclientid"); */

                           var tmp_userimg=$("#sp_userdetails").attr('data-sp_userimage');
                           var tmp_userid=$("#sp_userdetails").attr('data-sp_userid');
                           var tmp_userclientId=$("#sp_userdetails").attr('data-sp_userclientid');
                           var tmp_username=$("#sp_userdetails").attr('data-sp_username');


                         /* var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='/static/images/user_img.png' width='30' height='30' alt='user-image'></div></div>"; */


                          var userHtml = "<div id='user-info'> <div class='userText'><span>"+rawText+"</span></div> <div id='user-img'><img src='"+tmp_userimg+"' width='30' height='30' alt='user-image'></div></div>";


                          $("#textInput").val("");
                          $("#chatbox").append(userHtml);

                          var loadingReport="<div class='loader'><div id='loadingText'>Working on this.Please wait</div><div id='loadingImg'><img border=0 src='/static/images/loading.gif'></img></div></div>";

                          $("#chatbox").append(loadingReport);


                          //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                          var tmpHeight = document.getElementById("chatbox").scrollHeight;
                          $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");

                          $.get("/action/bot/", { msg: rawText,userId:tmp_userid,clientId:tmp_userclientId,userName:tmp_username }).done(function(data) {
                            //var botHtml = '<p class="botText"><span>' + data + '</span></p>';


                            var botHtml="<div id='sam-info'>  <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div> <div class='botText'><span>"+data+"</span></div></div>";
                            //var botHtml="jjjj";
                            $("#chatbox").append(botHtml);
                            //alert('before hide');
                            $(".loader").hide();
                           // alert('After hide');
                            //document.getElementById('userInput').scrollIntoView({block: 'start', behavior: 'smooth'});
                              var tmpHeight = document.getElementById("chatbox").scrollHeight;
                              $("#chatbox").animate({ scrollTop: tmpHeight }, "slow");
                          });
                      }

               }
               $(function(){
                 setTimeout(function(){
                 //$('#sam-info').show();
                   $('.sam_suggestion').show();
                 },3500);
               });


    
  </script>
  <style type="text/css">

  </style>
  <body>
    <span id="sp_userdetails" style='display:none;'></span>
     <span id="dateSpan" style="display:none;">

        <div class="dateText" color:"black"><font class="dateText" size="3.5">Would you like to apply additional date filter on the data above?</font><br>
        <div class="dateText">choose some of these quick date ranges</div><br>
         <a href="javascript:clickMe('Today');"><div class="action-elem" style="padding: 0px 14px !important;">Today</div></a>
         <a href="javascript:clickMe('Yesterday');" ><div class="action-elem" style="padding: 0px 14px !important;">Yesterday</div></a>
         <a href="javascript:clickMe('7 days back');" ><div class="action-elem" style="padding: 0px 14px !important;">7 days back</div></a>
         <a href="javascript:clickMe('14 days back');" ><div class="action-elem" style="padding: 0px 14px !important;">14 days back</div></a>
         <a href="javascript:clickMe('30 days back');" ><div class="action-elem" style="padding: 0px 14px !important;">30 days back</div></a><br>
         <a href="javascript:clickMe('this week');" ><div class="action-elem" style="padding: 0px 14px !important;">This week</div></a>
         <a href="javascript:clickMe('this month');" ><div class="action-elem" style="padding: 0px 14px !important;">This month</div></a>
         <a href="javascript:clickMe('this quarter');" ><div class="action-elem" style="padding: 0px 14px !important;">This quarter</div></a>
         <a href="javascript:clickMe('this year');" ><div class="action-elem" style="padding: 0px 14px !important;">This year</div></a>
         <a href="javascript:clickMe('All Time');" ><div class="action-elem" style="padding: 0px 14px !important;">All Time</div></a><br>
        <div class="dateText">or type your required date range below...</div>
        </div>

    </span>

    <div id="chatboxServer">
      <div id="chatbox">
        <!-- <p class="botText "><span>Hi! How can i help you Today?</span></p> -->
            <div id='sam-info' style="margin-top: 10px;">
                <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div>
               <div class='botText'>
                 <span>Hi <label id="name_label_id"></label>, how can I help?</span><br/><br/></div><br>
	      <!-- <div class='botText'><span>here are some quick links you could try...</span></div>
	       <a href="javascript:clickMe('Show my Sales Pipelie');"><div class="action-elem" >Show my Sales Pipelie</div></a>
	       <a href="javascript:clickMe('Show my win probability');"><div class="action-elem" >Show my win probability</div></a>
               <a href="javascript:clickMe('Show my closed opportunities');"><div class="action-elem" >Show my closed opportunities</div></a> -->
            </div>
	   <!-- <div id='sam-info' class='sam_suggestion'  style="display:none;">
                <div id='sam-img'><img src='/static/images/sam_img.png' width='30' height='30' alt='sam-image'></div>
               <div class='botText'>
                 <span>Would you like to check?</span><br/><br/>
                 <span><a href="javascript:clickMeHere('sales pipeline')"><span class="action-elem">Sales Pipeline</span></a></span>
                 <span><a href="javascript:clickMeHere('win probability')"><span class="action-elem">Win Probability</span></a></span>
                 <span><a href="javascript:clickMeHere('pending deals')"><span class="action-elem">Pending Deals</span></a></span>
                 <span><a href="javascript:clickMeHere('Sales Stages')"><span class="action-elem">Sales Stages</span></a></span>
                </div><br>
            </div> --> 
      </div> 

      <div id="iAskQuestionContainer"> 
          <div id="userInput" align="center">
            <div id="textInputDiv">
              <input id="textInput" type="text" name="msg" placeholder="What would you like me to do" autofocus="" class="ui-autocomplete-input" autocomplete="off">
            </div>

            <!--<div id="buttonInputDiv">
              <input id="buttonInput1" type="submit" value="Send" style="display:none;">
              <img src="/static/images/chat_send.png" border="0" id="buttonInput" style="width:30px;height:30px;">
            </div>-->
            <input id="buttonInput" type="submit" value="Send" style="display:none;">
             <div id="buttonInputDiv">
                    <input id="buttonInput1" type="submit" value="Send" style="display:none;">
                    <span id="final_span" class="final" style="display:none;"></span>
                    <span id="interim_span" class="interim" style="display:none;"></span>
                    <div id="voiceDiv" style="display:none;"></div>
                    <button id="start_button" onclick="startButton(event);" style="border:0;">
                        <img id="start_img" src="/static/images/mic.gif" alt="Start" border="0">
                    </button>
                </div>

          </div>

           <!-- start for web -->
          <div id="iAskQuestionType"  style="margin-left: 4%;">
             <div id="chatbotMiddle" style="position: relative; display: block;padding-top: 14px;padding-bottom: 4px;">
                
               <input type="radio" name="questionType" value='action' id='action_type'  class='questionRadio' checked><label for='action_type'>
                    <span style="color: #888;position: relative;bottom: 3px;left: 0px; font-size: 12px;font-weight: 600;"><div class="action-elem-new-selected" style="margin-left: 5px;padding-top:3px;padding-bottom:3px;">Actions</div></span></label> 

                <input type="radio" name="questionType" value='data' id='data_type' class='questionRadio'><label for='data_type'>
                <span style="color: #888;position: relative;bottom: 3px;left: 0px;font-size: 12px;font-weight: 600;"><div class="action-elem-new" style="margin-left: 5px;padding-top:3px;padding-bottom:3px;">Intelligence</div>
                </span></label>  

                <input type="radio" name="questionType" value='support' id='support_type' class='questionRadio'><label for='support_type'>
                <span style="color: #888;position: relative;bottom: 3px;left: 0px;font-size: 12px;font-weight: 600;"><div class="action-elem-new" style="margin-left: 5px;padding-top:3px;padding-bottom:3px;">Help</div></span></label> 

            </div> 
          </div>

           <!-- end for web -->

     </div>

    </div>
  </body>
</html> 
